---
description: AniVerse 프로젝트의 기술 스택(Next.js 16, Zustand, TanStack Query) 및 코딩 컨벤션 정의
globs: **/*
alwaysApply: true
---

# AniVerse Project Rules

아래의 조건 및 주의사항을 모두 적용하여 코드를 작성할 것.

## 1. 기술 스택 및 환경 (Tech Stack)

- **Framework:** Next.js 16 (App Router, Turbopack)
- **Core Library:** React 19 (RC/Stable)
- **Language:** TypeScript 5.x (Strict Mode)
- **Styling:** Tailwind CSS 4.x (or latest compatible v3.4+)
- **Backend:** Supabase (Auth, DB)
- **State Management (Hybrid Strategy):**
- **Server State:** TanStack Query v5 (@tanstack/react-query) - API 캐싱, 무한 스크롤
- **Client UI State:** Zustand v5 - 모달 제어, 전역 UI 설정
- **i18n:** next-intl

## 2. 상태 관리 원칙 (State Management Rules)

**가장 중요한 규칙임.** 데이터의 성격에 따라 도구를 엄격히 구분한다.

- **Server Data (API):**
  - 기본적으로 **Server Components**에서 `fetch`로 데이터를 가져와 렌더링하는 것을 1순위로 한다. (초기 로딩 속도 최적화)
  - 클라이언트 사이드 인터랙션(무한 스크롤, 실시간 필터링, 낙관적 업데이트)이 필요한 경우에만 **TanStack Query** (`useQuery`, `useMutation`)를 사용한다.
  - `useEffect`로 API를 직접 호출하여 상태에 넣는 행위를 금지한다.
- **Client State (UI):**
  - 앱 전역에서 공유되는 UI 상태(로그인 모달 열림 여부, 사이드바 토글 등)는 **Zustand** Store로 관리한다.
  - 단순한 컴포넌트 내부 상태(Form 입력값 등)는 `useState`를 사용한다.

## 3. 코딩 스타일 및 원칙 (Coding Standards)

- **Next.js 16 / React 19 Patterns:**
  - `use client` 지시어는 꼭 필요한 파일 최상단에만 작성한다.
  - 데이터 변형(Form Submit 등)은 **Server Actions**를 우선 고려한다.
- **Styling:**
  - Tailwind Utility Class를 우선 사용한다. (`styles.module.css` 등 별도 파일 생성 금지)
  - 색상은 `bg-zinc-950`, `text-blue-500` 등 지정된 디자인 시스템 토큰을 준수한다.
- **Types:**
  - `any` 타입 사용을 엄격히 금지한다.
  - DB 스키마 타입은 Supabase에서 생성된 타입을 `import`하여 사용한다.

## 4. 폴더 구조 (Directory Structure)

아래 구조를 엄격히 준수한다.

- `/src/app`: 페이지 라우팅 (App Router)
- `/src/components`: UI 컴포넌트 (Atomic Design 지향)
- `/src/hooks`: 커스텀 훅 (TanStack Query, Zustand 관련 훅 포함)
- `/src/lib`: 유틸리티, API 클라이언트(Supabase, TMDB, OpenAI) 설정
- `/src/stores`: Zustand 스토어 정의 (`useStore.ts` 등)
- `/src/providers`: QueryClientProvider 등 전역 프로바이더
- `/src/types`: TypeScript 타입 정의
- `/messages`: 다국어 JSON 파일

## 5. GIT 컨벤션 (Conventional Commits)

작업 완료 후 커밋 메시지는 **한국어**로 작성한다.

- `feat`: 새로운 기능 추가 (예: `feat: 주스탠드 스토어 초기 설정`)
- `fix`: 버그 수정
- `docs`: 문서 수정
- `style`: 코드 포맷팅
- `refactor`: 코드 리팩토링 (기능 변경 없음)
- `chore`: 설정 파일 수정, 패키지 업데이트

## 6. 작업 프로세스 (Workflow)

AI는 작업을 시작하기 전에 다음 단계를 수행해야 한다.

1.  **분석 (Analyze):** `package.json`을 확인하여 Next.js 16 및 관련 라이브러리 버전을 파악한다.
2.  **계획 (Plan):** 구현할 기능의 단계를 step-by-step으로 정리한다.
3.  **구현 (Implement):** 계획에 따라 코드를 작성한다. (Server Component 우선 원칙 준수)
4.  **검토 (Review):** 상태 관리 도구(Zustand vs TanStack Query)가 적절히 사용되었는지 확인한다.
5.  **확인 (Verify):** `npm run build`를 통해 빌드 오류가 없는지 확인한다.
